# nix-ttf-ms-win11-auto

Nix flake providing Microsoft Windows 11 fonts, automatically extracted from the official installation media.

This project is a port of the most excellent Arch Linux AUR packages [ttf-ms-win11-auto](https://aur.archlinux.org/packages/ttf-ms-win11-auto) and [ttf-ms-win11-fod-auto](https://aur.archlinux.org/packages?K=ttf-ms-win11-fod+auto).

## Disclaimer

**Please note that using Microsoft fonts outside a Windows system is prohibited by the EULA (though it may be unenforceable in some jurisdictions). Please consult Microsoft license before using these fonts.**

**It goes without saying that, if you do not have a Windows 11 license, you probably cannot lawfully install these fonts in most jurisdictions.**

**I in no way endorse or encourage the use of these fonts in any way that violates the Microsoft EULA or any applicable laws. This package is provided for educational purposes only.**

## Usage

### In a NixOS configuration

```nix
{
  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
    nix-ttf-ms-win11-auto.url = "github:kugland/nix-ttf-ms-win11-auto";
  };

  outputs = {
    nixpkgs,
    nix-ttf-ms-win11-auto,
    ...
  }: {
    nixosConfigurations.my-machine = nixpkgs.lib.nixosSystem {
      system = "x86_64-linux";
      modules = [
        ({pkgs, ...}: {
          # Allow unfree packages is required for these fonts.
          nixpkgs.config.allowUnfree = true;

          fonts.packages = with nix-ttf-ms-win11-auto.packages.${pkgs.system}; [
            ttf-ms-win11-auto
            ttf-ms-win11-fod-auto-paneuropean
            # etc.
          ];
        })
      ];
    };
  };
}
```

**Important:** Do not set `nix-ttf-ms-win11-auto.inputs.nixpkgs.follows = "nixpkgs"` in your flake inputs. As of writing, the `httpdirfs` package (which is required by the extraction VM to mount the ISO) is broken in the _stable_ Nix channel; if your flake follows a `nixpkgs` that resolves to the stable channel (via `follows`), build will pick up the broken `httpdirfs` and fail.

### With `nix-profile`

```bash
nix profile install github:kugland/nix-ttf-ms-win11-auto#ttf-ms-win11-auto
nix profile install github:kugland/nix-ttf-ms-win11-auto#ttf-ms-win11-fod-auto-paneuropean
# etc.
```

### With the provided overlay

In your flake, add the input:

```nix
inputs.nix-ttf-ms-win11.url = "github:kugland/nix-ttf-ms-win11-auto";
```

Then, somewhere in your configuration, add the overlay:

```nix
{inputs, ...}: {
  nixpkgs.overlays = [inputs.nix-ttf-ms-win11.overlays.default];
}
```

And *voi-là*, the packages are all available under `pkgs`.


## Available packages and fonts

We provide the package `ttf-ms-win11-auto-all`, a `symlinkJoin` of all packages
in this flake, as well as individual packages for each font group.

The available packages (other than `ttf-ms-win11-auto-all`) and the fonts they
provide are as follows:

<!-- begin generated by extract-names -->
- `ttf-ms-win11-auto`:
  - *Arial*
  - *Arial Black*
  - *Bahnschrift*
  - *Calibri*
  - *Calibri Light*
  - *Cambria*
  - *Candara*
  - *Candara Light*
  - *Comic Sans MS*
  - *Consolas*
  - *Constantia*
  - *Corbel*
  - *Corbel Light*
  - *Courier New*
  - *Franklin Gothic Medium*
  - *Gabriola*
  - *Georgia*
  - *Impact*
  - *Ink Free*
  - *Lucida Console*
  - *Lucida Sans Unicode*
  - *Marlett*
  - *Microsoft Sans Serif*
  - *Palatino Linotype*
  - *Segoe Fluent Icons*
  - *Segoe MDL2 Assets*
  - *Segoe Print*
  - *Segoe Script*
  - *Segoe UI*
  - *Segoe UI Black*
  - *Segoe UI Emoji*
  - *Segoe UI Historic*
  - *Segoe UI Light*
  - *Segoe UI Semibold*
  - *Segoe UI Semilight*
  - *Segoe UI Symbol*
  - *Segoe UI Variable*
  - *Sitka Text*
  - *Sylfaen*
  - *Symbol*
  - *Tahoma*
  - *Times New Roman*
  - *Trebuchet MS*
  - *Verdana*
  - *Webdings*
  - *Wingdings*
- `ttf-ms-win11-auto-japanese`:
  - *MS Gothic*
  - *Yu Gothic*
  - *Yu Gothic Light*
  - *Yu Gothic Medium*
- `ttf-ms-win11-auto-korean`:
  - *Malgun Gothic*
  - *Malgun Gothic Semilight*
- `ttf-ms-win11-auto-other`:
  - *Ebrima*
  - *Gadugi*
  - *MV Boli*
- `ttf-ms-win11-auto-sea`:
  - *Javanese Text*
  - *Microsoft Himalaya*
  - *Microsoft New Tai Lue*
  - *Microsoft PhagsPa*
  - *Microsoft Tai Le*
  - *Microsoft Yi Baiti*
  - *Mongolian Baiti*
  - *Myanmar Text*
  - *Nirmala UI*
- `ttf-ms-win11-auto-thai`:
  - *Leelawadee UI*
  - *Leelawadee UI Semilight*
- `ttf-ms-win11-auto-zh_cn`:
  - *Microsoft YaHei*
  - *Microsoft YaHei Light*
  - *SimSun*
  - *SimSun-ExtB*
- `ttf-ms-win11-auto-zh_tw`:
  - *Microsoft JhengHei*
  - *Microsoft JhengHei Light*
  - *MingLiU-ExtB*
- `ttf-ms-win11-fod-auto-arab`:
  - *Aldhabi*
  - *Andalus*
  - *Arabic Typesetting*
  - *Microsoft Uighur*
  - *Sakkal Majalla*
  - *Simplified Arabic*
  - *Simplified Arabic Fixed*
  - *Traditional Arabic*
  - *Urdu Typesetting*
- `ttf-ms-win11-fod-auto-beng`:
  - *Shonar Bangla*
  - *Vrinda*
- `ttf-ms-win11-fod-auto-cans`:
  - *Euphemia*
- `ttf-ms-win11-fod-auto-cher`:
  - *Plantagenet Cherokee*
- `ttf-ms-win11-fod-auto-deva`:
  - *Aparajita*
  - *Kokila*
  - *Mangal*
  - *Sanskrit Text*
  - *Utsaah*
- `ttf-ms-win11-fod-auto-ethi`:
  - *Nyala*
- `ttf-ms-win11-fod-auto-gujr`:
  - *Shruti*
- `ttf-ms-win11-fod-auto-guru`:
  - *Raavi*
- `ttf-ms-win11-fod-auto-hans`:
  - *DengXian*
  - *DengXian Light*
  - *FangSong*
  - *KaiTi*
  - *SimHei*
- `ttf-ms-win11-fod-auto-hant`:
  - *DFKai-SB*
  - *MingLiU*
- `ttf-ms-win11-fod-auto-hebr`:
  - *Aharoni*
  - *David*
  - *FrankRuehl*
  - *Gisha*
  - *Levenim MT*
  - *Miriam*
  - *Miriam Fixed*
  - *Narkisim*
  - *Rod*
- `ttf-ms-win11-fod-auto-jpan`:
  - *BIZ UDGothic*
  - *BIZ UDMincho Medium*
  - *Meiryo*
  - *MS Gothic*
  - *MS Mincho*
  - *UD Digi Kyokasho N*
  - *Yu Mincho*
  - *Yu Mincho Demibold*
  - *Yu Mincho Light*
- `ttf-ms-win11-fod-auto-khmr`:
  - *DaunPenh*
  - *Khmer UI*
  - *MoolBoran*
- `ttf-ms-win11-fod-auto-knda`:
  - *Tunga*
- `ttf-ms-win11-fod-auto-kore`:
  - *Batang*
  - *Gulim*
- `ttf-ms-win11-fod-auto-laoo`:
  - *DokChampa*
  - *Lao UI*
- `ttf-ms-win11-fod-auto-mlym`:
  - *Kartika*
- `ttf-ms-win11-fod-auto-orya`:
  - *Kalinga*
- `ttf-ms-win11-fod-auto-paneuropean`:
  - *Arial Nova*
  - *Arial Nova Cond*
  - *Arial Nova Cond Light*
  - *Arial Nova Light*
  - *Georgia Pro*
  - *Georgia Pro Black*
  - *Georgia Pro Cond*
  - *Georgia Pro Cond Black*
  - *Georgia Pro Cond Light*
  - *Georgia Pro Cond Semibold*
  - *Georgia Pro Light*
  - *Georgia Pro Semibold*
  - *Gill Sans Nova*
  - *Gill Sans Nova Cond*
  - *Gill Sans Nova Cond Lt*
  - *Gill Sans Nova Cond Ultra Bold*
  - *Gill Sans Nova Cond XBd*
  - *Gill Sans Nova Light*
  - *Gill Sans Nova Ultra Bold*
  - *Neue Haas Grotesk Text Pro*
  - *Rockwell Nova*
  - *Rockwell Nova Cond*
  - *Rockwell Nova Cond Light*
  - *Rockwell Nova Extra Bold*
  - *Rockwell Nova Light*
  - *Verdana Pro*
  - *Verdana Pro Black*
  - *Verdana Pro Cond*
  - *Verdana Pro Cond Black*
  - *Verdana Pro Cond Light*
  - *Verdana Pro Cond Semibold*
  - *Verdana Pro Light*
  - *Verdana Pro Semibold*
- `ttf-ms-win11-fod-auto-sinh`:
  - *Iskoola Pota*
- `ttf-ms-win11-fod-auto-syrc`:
  - *Estrangelo Edessa*
- `ttf-ms-win11-fod-auto-taml`:
  - *Latha*
  - *Vijaya*
- `ttf-ms-win11-fod-auto-telu`:
  - *Gautami*
  - *Vani*
- `ttf-ms-win11-fod-auto-thai`:
  - *Angsana New*
  - *Browallia New*
  - *Cordia New*
  - *DilleniaUPC*
  - *EucrosiaUPC*
  - *FreesiaUPC*
  - *IrisUPC*
  - *JasmineUPC*
  - *KodchiangUPC*
  - *Leelawadee*
  - *LilyUPC*
<!-- end generated by extract-names -->

## Why such a convoluted build process?

In order to extract the fonts _without_ having to download the entire Windows 11 ISO, we mount the ISO directly from Microsoft’s server using `httpdirfs`. However, `httpdirfs` requires FUSE, which is not available in the standard Nix build sandbox (it doesn’t have access to `/dev/fuse`); to circumvent this, we run the extraction process inside a virtual machine using `pkgs.vmTools.runInLinuxVM`, where we can `mknod` our way to FUSE.

## License

The fonts downloaded by this flake are proprietary software owned by Microsoft. This repository, however, doesn’t contain the font files themselves, only the Nix code to extract and package them, and this code is licensed under the MIT License; see the LICENSE file for details.
